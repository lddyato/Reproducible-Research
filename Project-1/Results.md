# Loading and preprocessing the data
```r
> if(!file.exists("data5")) dir.create("data5")
> fileurl <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
> download.file(fileurl, destfile = "./data5/Factivity.zip")
trying URL 'https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip'
Content type 'application/zip' length 53559 bytes (52 KB)
downloaded 52 KB

> unzip("./data5/Factivity.zip", exdir = "./data5")
> activity <- read.csv("./data5/activity.csv")
> dim(activity)
[1] 17568     3
> View(activity)
> activity$date <- as.Date(activity$date, format="%Y-%m-%d")
```
# What is mean total number of steps taken per day?
```r
> totalstep <- aggregate(steps ~ date, activity, sum)
> totalstep
         date steps
1  2012-10-02   126
2  2012-10-03 11352
3  2012-10-04 12116
4  2012-10-05 13294
5  2012-10-06 15420
6  2012-10-07 11015
7  2012-10-09 12811
8  2012-10-10  9900
9  2012-10-11 10304
10 2012-10-12 17382
11 2012-10-13 12426
12 2012-10-14 15098
13 2012-10-15 10139
14 2012-10-16 15084
15 2012-10-17 13452
16 2012-10-18 10056
17 2012-10-19 11829
18 2012-10-20 10395
19 2012-10-21  8821
20 2012-10-22 13460
21 2012-10-23  8918
22 2012-10-24  8355
23 2012-10-25  2492
24 2012-10-26  6778
25 2012-10-27 10119
26 2012-10-28 11458
27 2012-10-29  5018
28 2012-10-30  9819
29 2012-10-31 15414
30 2012-11-02 10600
31 2012-11-03 10571
32 2012-11-05 10439
33 2012-11-06  8334
34 2012-11-07 12883
35 2012-11-08  3219
36 2012-11-11 12608
37 2012-11-12 10765
38 2012-11-13  7336
39 2012-11-15    41
40 2012-11-16  5441
41 2012-11-17 14339
42 2012-11-18 15110
43 2012-11-19  8841
44 2012-11-20  4472
45 2012-11-21 12787
46 2012-11-22 20427
47 2012-11-23 21194
48 2012-11-24 14478
49 2012-11-25 11834
50 2012-11-26 11162
51 2012-11-27 13646
52 2012-11-28 10183
53 2012-11-29  7047
> totalstep01 <- tapply(activity$steps, activity$date, sum, na.rm = T)
2012-10-01 2012-10-02 2012-10-03 2012-10-04 2012-10-05 2012-10-06 2012-10-07 2012-10-08 2012-10-09 2012-10-10 2012-10-11 2012-10-12 2012-10-13 2012-10-14 
         0        126      11352      12116      13294      15420      11015          0      12811       9900      10304      17382      12426      15098 
2012-10-15 2012-10-16 2012-10-17 2012-10-18 2012-10-19 2012-10-20 2012-10-21 2012-10-22 2012-10-23 2012-10-24 2012-10-25 2012-10-26 2012-10-27 2012-10-28 
     10139      15084      13452      10056      11829      10395       8821      13460       8918       8355       2492       6778      10119      11458 
2012-10-29 2012-10-30 2012-10-31 2012-11-01 2012-11-02 2012-11-03 2012-11-04 2012-11-05 2012-11-06 2012-11-07 2012-11-08 2012-11-09 2012-11-10 2012-11-11 
      5018       9819      15414          0      10600      10571          0      10439       8334      12883       3219          0          0      12608 
2012-11-12 2012-11-13 2012-11-14 2012-11-15 2012-11-16 2012-11-17 2012-11-18 2012-11-19 2012-11-20 2012-11-21 2012-11-22 2012-11-23 2012-11-24 2012-11-25 
     10765       7336          0         41       5441      14339      15110       8841       4472      12787      20427      21194      14478      11834 
2012-11-26 2012-11-27 2012-11-28 2012-11-29 2012-11-30 
     11162      13646      10183       7047          0 
> binsize <- diff(range(totalstep$steps))/4 
> library(ggplot2)
> ggplot(totalstep, aes(x=steps)) + geom_histogram(fill="lightgreen", colour = "black", binwidth = binsize) + ylab("The total number of steps")

> meanstep <- aggregate(steps ~ date, activity, mean)
> meanstep
         date      steps
1  2012-10-02  0.4375000
2  2012-10-03 39.4166667
3  2012-10-04 42.0694444
4  2012-10-05 46.1597222
5  2012-10-06 53.5416667
6  2012-10-07 38.2465278
7  2012-10-09 44.4826389
8  2012-10-10 34.3750000
9  2012-10-11 35.7777778
10 2012-10-12 60.3541667
11 2012-10-13 43.1458333
12 2012-10-14 52.4236111
13 2012-10-15 35.2048611
14 2012-10-16 52.3750000
15 2012-10-17 46.7083333
16 2012-10-18 34.9166667
17 2012-10-19 41.0729167
18 2012-10-20 36.0937500
19 2012-10-21 30.6284722
20 2012-10-22 46.7361111
21 2012-10-23 30.9652778
22 2012-10-24 29.0104167
23 2012-10-25  8.6527778
24 2012-10-26 23.5347222
25 2012-10-27 35.1354167
26 2012-10-28 39.7847222
27 2012-10-29 17.4236111
28 2012-10-30 34.0937500
29 2012-10-31 53.5208333
30 2012-11-02 36.8055556
31 2012-11-03 36.7048611
32 2012-11-05 36.2465278
33 2012-11-06 28.9375000
34 2012-11-07 44.7326389
35 2012-11-08 11.1770833
36 2012-11-11 43.7777778
37 2012-11-12 37.3784722
38 2012-11-13 25.4722222
39 2012-11-15  0.1423611
40 2012-11-16 18.8923611
41 2012-11-17 49.7881944
42 2012-11-18 52.4652778
43 2012-11-19 30.6979167
44 2012-11-20 15.5277778
45 2012-11-21 44.3993056
46 2012-11-22 70.9270833
47 2012-11-23 73.5902778
48 2012-11-24 50.2708333
49 2012-11-25 41.0902778
50 2012-11-26 38.7569444
51 2012-11-27 47.3819444
52 2012-11-28 35.3576389
53 2012-11-29 24.4687500

> medianstep <- aggregate(steps ~ date, activity, median)
> medianstep
         date steps
1  2012-10-02     0
2  2012-10-03     0
3  2012-10-04     0
4  2012-10-05     0
5  2012-10-06     0
6  2012-10-07     0
7  2012-10-09     0
8  2012-10-10     0
9  2012-10-11     0
10 2012-10-12     0
11 2012-10-13     0
12 2012-10-14     0
13 2012-10-15     0
14 2012-10-16     0
15 2012-10-17     0
16 2012-10-18     0
17 2012-10-19     0
18 2012-10-20     0
19 2012-10-21     0
20 2012-10-22     0
21 2012-10-23     0
22 2012-10-24     0
23 2012-10-25     0
24 2012-10-26     0
25 2012-10-27     0
26 2012-10-28     0
27 2012-10-29     0
28 2012-10-30     0
29 2012-10-31     0
30 2012-11-02     0
31 2012-11-03     0
32 2012-11-05     0
33 2012-11-06     0
34 2012-11-07     0
35 2012-11-08     0
36 2012-11-11     0
37 2012-11-12     0
38 2012-11-13     0
39 2012-11-15     0
40 2012-11-16     0
41 2012-11-17     0
42 2012-11-18     0
43 2012-11-19     0
44 2012-11-20     0
45 2012-11-21     0
46 2012-11-22     0
47 2012-11-23     0
48 2012-11-24     0
49 2012-11-25     0
50 2012-11-26     0
51 2012-11-27     0
52 2012-11-28     0
53 2012-11-29     0

> meanstep01<- mean(totalstep$steps)
> meanstep01
[1] 10766.19

> medianstep01<- median(totalstep$steps)
> medianstep01
[1] 10765

> print(paste("The MEAN of the total number of steps taken on ", meanstep$date, " is ", round(meanstep$steps, 2)))
 [1] "The MEAN of the total number of steps taken on  2012-10-02  is  0.44" 
 [2] "The MEAN of the total number of steps taken on  2012-10-03  is  39.42"
 [3] "The MEAN of the total number of steps taken on  2012-10-04  is  42.07"
 [4] "The MEAN of the total number of steps taken on  2012-10-05  is  46.16"
 [5] "The MEAN of the total number of steps taken on  2012-10-06  is  53.54"
 [6] "The MEAN of the total number of steps taken on  2012-10-07  is  38.25"
 [7] "The MEAN of the total number of steps taken on  2012-10-09  is  44.48"
 [8] "The MEAN of the total number of steps taken on  2012-10-10  is  34.38"
 [9] "The MEAN of the total number of steps taken on  2012-10-11  is  35.78"
[10] "The MEAN of the total number of steps taken on  2012-10-12  is  60.35"
[11] "The MEAN of the total number of steps taken on  2012-10-13  is  43.15"
[12] "The MEAN of the total number of steps taken on  2012-10-14  is  52.42"
[13] "The MEAN of the total number of steps taken on  2012-10-15  is  35.2" 
[14] "The MEAN of the total number of steps taken on  2012-10-16  is  52.38"
[15] "The MEAN of the total number of steps taken on  2012-10-17  is  46.71"
[16] "The MEAN of the total number of steps taken on  2012-10-18  is  34.92"
[17] "The MEAN of the total number of steps taken on  2012-10-19  is  41.07"
[18] "The MEAN of the total number of steps taken on  2012-10-20  is  36.09"
[19] "The MEAN of the total number of steps taken on  2012-10-21  is  30.63"
[20] "The MEAN of the total number of steps taken on  2012-10-22  is  46.74"
[21] "The MEAN of the total number of steps taken on  2012-10-23  is  30.97"
[22] "The MEAN of the total number of steps taken on  2012-10-24  is  29.01"
[23] "The MEAN of the total number of steps taken on  2012-10-25  is  8.65" 
[24] "The MEAN of the total number of steps taken on  2012-10-26  is  23.53"
[25] "The MEAN of the total number of steps taken on  2012-10-27  is  35.14"
[26] "The MEAN of the total number of steps taken on  2012-10-28  is  39.78"
[27] "The MEAN of the total number of steps taken on  2012-10-29  is  17.42"
[28] "The MEAN of the total number of steps taken on  2012-10-30  is  34.09"
[29] "The MEAN of the total number of steps taken on  2012-10-31  is  53.52"
[30] "The MEAN of the total number of steps taken on  2012-11-02  is  36.81"
[31] "The MEAN of the total number of steps taken on  2012-11-03  is  36.7" 
[32] "The MEAN of the total number of steps taken on  2012-11-05  is  36.25"
[33] "The MEAN of the total number of steps taken on  2012-11-06  is  28.94"
[34] "The MEAN of the total number of steps taken on  2012-11-07  is  44.73"
[35] "The MEAN of the total number of steps taken on  2012-11-08  is  11.18"
[36] "The MEAN of the total number of steps taken on  2012-11-11  is  43.78"
[37] "The MEAN of the total number of steps taken on  2012-11-12  is  37.38"
[38] "The MEAN of the total number of steps taken on  2012-11-13  is  25.47"
[39] "The MEAN of the total number of steps taken on  2012-11-15  is  0.14" 
[40] "The MEAN of the total number of steps taken on  2012-11-16  is  18.89"
[41] "The MEAN of the total number of steps taken on  2012-11-17  is  49.79"
[42] "The MEAN of the total number of steps taken on  2012-11-18  is  52.47"
[43] "The MEAN of the total number of steps taken on  2012-11-19  is  30.7" 
[44] "The MEAN of the total number of steps taken on  2012-11-20  is  15.53"
[45] "The MEAN of the total number of steps taken on  2012-11-21  is  44.4" 
[46] "The MEAN of the total number of steps taken on  2012-11-22  is  70.93"
[47] "The MEAN of the total number of steps taken on  2012-11-23  is  73.59"
[48] "The MEAN of the total number of steps taken on  2012-11-24  is  50.27"
[49] "The MEAN of the total number of steps taken on  2012-11-25  is  41.09"
[50] "The MEAN of the total number of steps taken on  2012-11-26  is  38.76"
[51] "The MEAN of the total number of steps taken on  2012-11-27  is  47.38"
[52] "The MEAN of the total number of steps taken on  2012-11-28  is  35.36"
[53] "The MEAN of the total number of steps taken on  2012-11-29  is  24.47"
> print(paste("The MEDIAN of the total number of steps taken on ", meanstep$date, " is ", round(medianstep$steps, 2)))
 [1] "The MEDIAN of the total number of steps taken on  2012-10-02  is  0"
 [2] "The MEDIAN of the total number of steps taken on  2012-10-03  is  0"
 [3] "The MEDIAN of the total number of steps taken on  2012-10-04  is  0"
 [4] "The MEDIAN of the total number of steps taken on  2012-10-05  is  0"
 [5] "The MEDIAN of the total number of steps taken on  2012-10-06  is  0"
 [6] "The MEDIAN of the total number of steps taken on  2012-10-07  is  0"
 [7] "The MEDIAN of the total number of steps taken on  2012-10-09  is  0"
 [8] "The MEDIAN of the total number of steps taken on  2012-10-10  is  0"
 [9] "The MEDIAN of the total number of steps taken on  2012-10-11  is  0"
[10] "The MEDIAN of the total number of steps taken on  2012-10-12  is  0"
[11] "The MEDIAN of the total number of steps taken on  2012-10-13  is  0"
[12] "The MEDIAN of the total number of steps taken on  2012-10-14  is  0"
[13] "The MEDIAN of the total number of steps taken on  2012-10-15  is  0"
[14] "The MEDIAN of the total number of steps taken on  2012-10-16  is  0"
[15] "The MEDIAN of the total number of steps taken on  2012-10-17  is  0"
[16] "The MEDIAN of the total number of steps taken on  2012-10-18  is  0"
[17] "The MEDIAN of the total number of steps taken on  2012-10-19  is  0"
[18] "The MEDIAN of the total number of steps taken on  2012-10-20  is  0"
[19] "The MEDIAN of the total number of steps taken on  2012-10-21  is  0"
[20] "The MEDIAN of the total number of steps taken on  2012-10-22  is  0"
[21] "The MEDIAN of the total number of steps taken on  2012-10-23  is  0"
[22] "The MEDIAN of the total number of steps taken on  2012-10-24  is  0"
[23] "The MEDIAN of the total number of steps taken on  2012-10-25  is  0"
[24] "The MEDIAN of the total number of steps taken on  2012-10-26  is  0"
[25] "The MEDIAN of the total number of steps taken on  2012-10-27  is  0"
[26] "The MEDIAN of the total number of steps taken on  2012-10-28  is  0"
[27] "The MEDIAN of the total number of steps taken on  2012-10-29  is  0"
[28] "The MEDIAN of the total number of steps taken on  2012-10-30  is  0"
[29] "The MEDIAN of the total number of steps taken on  2012-10-31  is  0"
[30] "The MEDIAN of the total number of steps taken on  2012-11-02  is  0"
[31] "The MEDIAN of the total number of steps taken on  2012-11-03  is  0"
[32] "The MEDIAN of the total number of steps taken on  2012-11-05  is  0"
[33] "The MEDIAN of the total number of steps taken on  2012-11-06  is  0"
[34] "The MEDIAN of the total number of steps taken on  2012-11-07  is  0"
[35] "The MEDIAN of the total number of steps taken on  2012-11-08  is  0"
[36] "The MEDIAN of the total number of steps taken on  2012-11-11  is  0"
[37] "The MEDIAN of the total number of steps taken on  2012-11-12  is  0"
[38] "The MEDIAN of the total number of steps taken on  2012-11-13  is  0"
[39] "The MEDIAN of the total number of steps taken on  2012-11-15  is  0"
[40] "The MEDIAN of the total number of steps taken on  2012-11-16  is  0"
[41] "The MEDIAN of the total number of steps taken on  2012-11-17  is  0"
[42] "The MEDIAN of the total number of steps taken on  2012-11-18  is  0"
[43] "The MEDIAN of the total number of steps taken on  2012-11-19  is  0"
[44] "The MEDIAN of the total number of steps taken on  2012-11-20  is  0"
[45] "The MEDIAN of the total number of steps taken on  2012-11-21  is  0"
[46] "The MEDIAN of the total number of steps taken on  2012-11-22  is  0"
[47] "The MEDIAN of the total number of steps taken on  2012-11-23  is  0"
[48] "The MEDIAN of the total number of steps taken on  2012-11-24  is  0"
[49] "The MEDIAN of the total number of steps taken on  2012-11-25  is  0"
[50] "The MEDIAN of the total number of steps taken on  2012-11-26  is  0"
[51] "The MEDIAN of the total number of steps taken on  2012-11-27  is  0"
[52] "The MEDIAN of the total number of steps taken on  2012-11-28  is  0"
[53] "The MEDIAN of the total number of steps taken on  2012-11-29  is  0"

> print(paste("The MEAN of the total number of steps taken is", round(meanstep01, 2)))
[1] "The MEAN of the total number of steps taken is 10766.19"
> print(paste("The MEDIAN of the total number of steps taken is", round(medianstep01, 2)))
[1] "The MEDIAN of the total number of steps taken is 10765"
```
# What is the average daily activity pattern?
```r
> interstep <- aggregate(steps ~ interval, activity, mean)
> interstep
    interval       steps
1          0   1.7169811
2          5   0.3396226
3         10   0.1320755
4         15   0.1509434
5         20   0.0754717
6         25   2.0943396
7         30   0.5283019
8         35   0.8679245
9         40   0.0000000
10        45   1.4716981
11        50   0.3018868
12        55   0.1320755
13       100   0.3207547
14       105   0.6792453
15       110   0.1509434
16       115   0.3396226
17       120   0.0000000
18       125   1.1132075
19       130   1.8301887
20       135   0.1698113
21       140   0.1698113
22       145   0.3773585
23       150   0.2641509
24       155   0.0000000
25       200   0.0000000
26       205   0.0000000
27       210   1.1320755
28       215   0.0000000
29       220   0.0000000
30       225   0.1320755
31       230   0.0000000
32       235   0.2264151
33       240   0.0000000
34       245   0.0000000
35       250   1.5471698
36       255   0.9433962
37       300   0.0000000
38       305   0.0000000
39       310   0.0000000
40       315   0.0000000
41       320   0.2075472
42       325   0.6226415
43       330   1.6226415
44       335   0.5849057
45       340   0.4905660
46       345   0.0754717
47       350   0.0000000
48       355   0.0000000
49       400   1.1886792
50       405   0.9433962
51       410   2.5660377
52       415   0.0000000
53       420   0.3396226
54       425   0.3584906
55       430   4.1132075
56       435   0.6603774
57       440   3.4905660
58       445   0.8301887
59       450   3.1132075
60       455   1.1132075
61       500   0.0000000
62       505   1.5660377
63       510   3.0000000
64       515   2.2452830
65       520   3.3207547
66       525   2.9622642
67       530   2.0943396
68       535   6.0566038
69       540  16.0188679
70       545  18.3396226
71       550  39.4528302
72       555  44.4905660
73       600  31.4905660
74       605  49.2641509
75       610  53.7735849
76       615  63.4528302
77       620  49.9622642
78       625  47.0754717
79       630  52.1509434
80       635  39.3396226
81       640  44.0188679
82       645  44.1698113
83       650  37.3584906
84       655  49.0377358
85       700  43.8113208
86       705  44.3773585
87       710  50.5094340
88       715  54.5094340
89       720  49.9245283
90       725  50.9811321
91       730  55.6792453
92       735  44.3207547
93       740  52.2641509
94       745  69.5471698
95       750  57.8490566
96       755  56.1509434
97       800  73.3773585
98       805  68.2075472
99       810 129.4339623
100      815 157.5283019
101      820 171.1509434
102      825 155.3962264
103      830 177.3018868
104      835 206.1698113
105      840 195.9245283
106      845 179.5660377
107      850 183.3962264
108      855 167.0188679
109      900 143.4528302
110      905 124.0377358
111      910 109.1132075
112      915 108.1132075
113      920 103.7169811
114      925  95.9622642
115      930  66.2075472
116      935  45.2264151
117      940  24.7924528
118      945  38.7547170
119      950  34.9811321
120      955  21.0566038
121     1000  40.5660377
122     1005  26.9811321
123     1010  42.4150943
124     1015  52.6603774
125     1020  38.9245283
126     1025  50.7924528
127     1030  44.2830189
128     1035  37.4150943
129     1040  34.6981132
130     1045  28.3396226
131     1050  25.0943396
132     1055  31.9433962
133     1100  31.3584906
134     1105  29.6792453
135     1110  21.3207547
136     1115  25.5471698
137     1120  28.3773585
138     1125  26.4716981
139     1130  33.4339623
140     1135  49.9811321
141     1140  42.0377358
142     1145  44.6037736
143     1150  46.0377358
144     1155  59.1886792
145     1200  63.8679245
146     1205  87.6981132
147     1210  94.8490566
148     1215  92.7735849
149     1220  63.3962264
150     1225  50.1698113
151     1230  54.4716981
152     1235  32.4150943
153     1240  26.5283019
154     1245  37.7358491
155     1250  45.0566038
156     1255  67.2830189
157     1300  42.3396226
158     1305  39.8867925
159     1310  43.2641509
160     1315  40.9811321
161     1320  46.2452830
162     1325  56.4339623
163     1330  42.7547170
164     1335  25.1320755
165     1340  39.9622642
166     1345  53.5471698
167     1350  47.3207547
168     1355  60.8113208
169     1400  55.7547170
170     1405  51.9622642
171     1410  43.5849057
172     1415  48.6981132
173     1420  35.4716981
174     1425  37.5471698
175     1430  41.8490566
176     1435  27.5094340
177     1440  17.1132075
178     1445  26.0754717
179     1450  43.6226415
180     1455  43.7735849
181     1500  30.0188679
182     1505  36.0754717
183     1510  35.4905660
184     1515  38.8490566
185     1520  45.9622642
186     1525  47.7547170
187     1530  48.1320755
188     1535  65.3207547
189     1540  82.9056604
190     1545  98.6603774
191     1550 102.1132075
192     1555  83.9622642
193     1600  62.1320755
194     1605  64.1320755
195     1610  74.5471698
196     1615  63.1698113
197     1620  56.9056604
198     1625  59.7735849
199     1630  43.8679245
200     1635  38.5660377
201     1640  44.6603774
202     1645  45.4528302
203     1650  46.2075472
204     1655  43.6792453
205     1700  46.6226415
206     1705  56.3018868
207     1710  50.7169811
208     1715  61.2264151
209     1720  72.7169811
210     1725  78.9433962
211     1730  68.9433962
212     1735  59.6603774
213     1740  75.0943396
214     1745  56.5094340
215     1750  34.7735849
216     1755  37.4528302
217     1800  40.6792453
218     1805  58.0188679
219     1810  74.6981132
220     1815  85.3207547
221     1820  59.2641509
222     1825  67.7735849
223     1830  77.6981132
224     1835  74.2452830
225     1840  85.3396226
226     1845  99.4528302
227     1850  86.5849057
228     1855  85.6037736
229     1900  84.8679245
230     1905  77.8301887
231     1910  58.0377358
232     1915  53.3584906
233     1920  36.3207547
234     1925  20.7169811
235     1930  27.3962264
236     1935  40.0188679
237     1940  30.2075472
238     1945  25.5471698
239     1950  45.6603774
240     1955  33.5283019
241     2000  19.6226415
242     2005  19.0188679
243     2010  19.3396226
244     2015  33.3396226
245     2020  26.8113208
246     2025  21.1698113
247     2030  27.3018868
248     2035  21.3396226
249     2040  19.5471698
250     2045  21.3207547
251     2050  32.3018868
252     2055  20.1509434
253     2100  15.9433962
254     2105  17.2264151
255     2110  23.4528302
256     2115  19.2452830
257     2120  12.4528302
258     2125   8.0188679
259     2130  14.6603774
260     2135  16.3018868
261     2140   8.6792453
262     2145   7.7924528
263     2150   8.1320755
264     2155   2.6226415
265     2200   1.4528302
266     2205   3.6792453
267     2210   4.8113208
268     2215   8.5094340
269     2220   7.0754717
270     2225   8.6981132
271     2230   9.7547170
272     2235   2.2075472
273     2240   0.3207547
274     2245   0.1132075
275     2250   1.6037736
276     2255   4.6037736
277     2300   3.3018868
278     2305   2.8490566
279     2310   0.0000000
280     2315   0.8301887
281     2320   0.9622642
282     2325   1.5849057
283     2330   2.6037736
284     2335   4.6981132
285     2340   3.3018868
286     2345   0.6415094
287     2350   0.2264151
288     2355   1.0754717
> View(interstep)
> ggplot(interstep, aes(x=interval, y=steps)) + geom_line(colour="green") + xlab("5-minute interval") + ylab("The average number of steps")
> interstep01 <- tapply(activity$steps, activity$interval, mean, na.rm=T)
> interstep01
          0           5          10          15          20          25          30          35          40          45          50          55         100 
  1.7169811   0.3396226   0.1320755   0.1509434   0.0754717   2.0943396   0.5283019   0.8679245   0.0000000   1.4716981   0.3018868   0.1320755   0.3207547 
        105         110         115         120         125         130         135         140         145         150         155         200         205 
  0.6792453   0.1509434   0.3396226   0.0000000   1.1132075   1.8301887   0.1698113   0.1698113   0.3773585   0.2641509   0.0000000   0.0000000   0.0000000 
        210         215         220         225         230         235         240         245         250         255         300         305         310 
  1.1320755   0.0000000   0.0000000   0.1320755   0.0000000   0.2264151   0.0000000   0.0000000   1.5471698   0.9433962   0.0000000   0.0000000   0.0000000 
        315         320         325         330         335         340         345         350         355         400         405         410         415 
  0.0000000   0.2075472   0.6226415   1.6226415   0.5849057   0.4905660   0.0754717   0.0000000   0.0000000   1.1886792   0.9433962   2.5660377   0.0000000 
        420         425         430         435         440         445         450         455         500         505         510         515         520 
  0.3396226   0.3584906   4.1132075   0.6603774   3.4905660   0.8301887   3.1132075   1.1132075   0.0000000   1.5660377   3.0000000   2.2452830   3.3207547 
        525         530         535         540         545         550         555         600         605         610         615         620         625 
  2.9622642   2.0943396   6.0566038  16.0188679  18.3396226  39.4528302  44.4905660  31.4905660  49.2641509  53.7735849  63.4528302  49.9622642  47.0754717 
        630         635         640         645         650         655         700         705         710         715         720         725         730 
 52.1509434  39.3396226  44.0188679  44.1698113  37.3584906  49.0377358  43.8113208  44.3773585  50.5094340  54.5094340  49.9245283  50.9811321  55.6792453 
        735         740         745         750         755         800         805         810         815         820         825         830         835 
 44.3207547  52.2641509  69.5471698  57.8490566  56.1509434  73.3773585  68.2075472 129.4339623 157.5283019 171.1509434 155.3962264 177.3018868 206.1698113 
        840         845         850         855         900         905         910         915         920         925         930         935         940 
195.9245283 179.5660377 183.3962264 167.0188679 143.4528302 124.0377358 109.1132075 108.1132075 103.7169811  95.9622642  66.2075472  45.2264151  24.7924528 
        945         950         955        1000        1005        1010        1015        1020        1025        1030        1035        1040        1045 
 38.7547170  34.9811321  21.0566038  40.5660377  26.9811321  42.4150943  52.6603774  38.9245283  50.7924528  44.2830189  37.4150943  34.6981132  28.3396226 
       1050        1055        1100        1105        1110        1115        1120        1125        1130        1135        1140        1145        1150 
 25.0943396  31.9433962  31.3584906  29.6792453  21.3207547  25.5471698  28.3773585  26.4716981  33.4339623  49.9811321  42.0377358  44.6037736  46.0377358 
       1155        1200        1205        1210        1215        1220        1225        1230        1235        1240        1245        1250        1255 
 59.1886792  63.8679245  87.6981132  94.8490566  92.7735849  63.3962264  50.1698113  54.4716981  32.4150943  26.5283019  37.7358491  45.0566038  67.2830189 
       1300        1305        1310        1315        1320        1325        1330        1335        1340        1345        1350        1355        1400 
 42.3396226  39.8867925  43.2641509  40.9811321  46.2452830  56.4339623  42.7547170  25.1320755  39.9622642  53.5471698  47.3207547  60.8113208  55.7547170 
       1405        1410        1415        1420        1425        1430        1435        1440        1445        1450        1455        1500        1505 
 51.9622642  43.5849057  48.6981132  35.4716981  37.5471698  41.8490566  27.5094340  17.1132075  26.0754717  43.6226415  43.7735849  30.0188679  36.0754717 
       1510        1515        1520        1525        1530        1535        1540        1545        1550        1555        1600        1605        1610 
 35.4905660  38.8490566  45.9622642  47.7547170  48.1320755  65.3207547  82.9056604  98.6603774 102.1132075  83.9622642  62.1320755  64.1320755  74.5471698 
       1615        1620        1625        1630        1635        1640        1645        1650        1655        1700        1705        1710        1715 
 63.1698113  56.9056604  59.7735849  43.8679245  38.5660377  44.6603774  45.4528302  46.2075472  43.6792453  46.6226415  56.3018868  50.7169811  61.2264151 
       1720        1725        1730        1735        1740        1745        1750        1755        1800        1805        1810        1815        1820 
 72.7169811  78.9433962  68.9433962  59.6603774  75.0943396  56.5094340  34.7735849  37.4528302  40.6792453  58.0188679  74.6981132  85.3207547  59.2641509 
       1825        1830        1835        1840        1845        1850        1855        1900        1905        1910        1915        1920        1925 
 67.7735849  77.6981132  74.2452830  85.3396226  99.4528302  86.5849057  85.6037736  84.8679245  77.8301887  58.0377358  53.3584906  36.3207547  20.7169811 
       1930        1935        1940        1945        1950        1955        2000        2005        2010        2015        2020        2025        2030 
 27.3962264  40.0188679  30.2075472  25.5471698  45.6603774  33.5283019  19.6226415  19.0188679  19.3396226  33.3396226  26.8113208  21.1698113  27.3018868 
       2035        2040        2045        2050        2055        2100        2105        2110        2115        2120        2125        2130        2135 
 21.3396226  19.5471698  21.3207547  32.3018868  20.1509434  15.9433962  17.2264151  23.4528302  19.2452830  12.4528302   8.0188679  14.6603774  16.3018868 
       2140        2145        2150        2155        2200        2205        2210        2215        2220        2225        2230        2235        2240 
  8.6792453   7.7924528   8.1320755   2.6226415   1.4528302   3.6792453   4.8113208   8.5094340   7.0754717   8.6981132   9.7547170   2.2075472   0.3207547 
       2245        2250        2255        2300        2305        2310        2315        2320        2325        2330        2335        2340        2345 
  0.1132075   1.6037736   4.6037736   3.3018868   2.8490566   0.0000000   0.8301887   0.9622642   1.5849057   2.6037736   4.6981132   3.3018868   0.6415094 
       2350        2355 
  0.2264151   1.0754717  
> View(interstep01)

> interstep[which.max(interstep$steps), ]
    interval    steps
104      835 206.1698
> maxinterval <- interstep[which.max(interstep$steps), ]$interval
> interstep01[which.max(interstep01)]
     835 
206.1698 
> maxinterval
[1] 835


> # Imputing missing values
> nacount01 <- table(is.na(activity))
> nacount01

FALSE  TRUE 
50400  2304 
> nacount <- sum(is.na(activity))
> nacount
[1] 2304
> print(paste("The total number of missing vlaues is", nacount))
[1] "The total number of missing vlaues is 2304"
> 
> nadata <- activity[is.na(activity$steps), ]
> nadata$steps <- interstep$steps[match(nadata$interval, interstep$interval)]
> head(nadata)
      steps       date interval
1 1.7169811 2012-10-01        0
2 0.3396226 2012-10-01        5
3 0.1320755 2012-10-01       10
4 0.1509434 2012-10-01       15
5 0.0754717 2012-10-01       20
6 2.0943396 2012-10-01       25
> newactivity <- rbind(activity[!is.na(activity$steps), ], nadata)
> head(newactivity)
    steps       date interval
289     0 2012-10-02        0
290     0 2012-10-02        5
291     0 2012-10-02       10
292     0 2012-10-02       15
293     0 2012-10-02       20
294     0 2012-10-02       25
> 
> newtotstep <- aggregate(steps ~ date, newactivity, sum)
> head(newtotstep)
        date    steps
1 2012-10-01 10766.19
2 2012-10-02   126.00
3 2012-10-03 11352.00
4 2012-10-04 12116.00
5 2012-10-05 13294.00
6 2012-10-06 15420.00
> binsize <- diff(range(newtotstep$steps))/8  
> ggplot(newtotstep, aes(x=steps)) + geom_histogram(fill="lightgreen", colour = "black", binwidth = binsize) + ylab("The total number of steps")
```
# use new dataset to calculate and report the mean and median number of steps taken each day
```r
> newmeanstep <- aggregate(steps ~ date, newactivity, mean)
> newmedianstep <- aggregate(steps ~ date, newactivity, median)
> newmeanstep01 <- mean(newtotstep$steps)
> newmedianstep01 <- median(newtotstep$steps)
> newmeanstep
         date      steps
1  2012-10-01 37.3825996
2  2012-10-02  0.4375000
3  2012-10-03 39.4166667
4  2012-10-04 42.0694444
5  2012-10-05 46.1597222
6  2012-10-06 53.5416667
7  2012-10-07 38.2465278
8  2012-10-08 37.3825996
9  2012-10-09 44.4826389
10 2012-10-10 34.3750000
11 2012-10-11 35.7777778
12 2012-10-12 60.3541667
13 2012-10-13 43.1458333
14 2012-10-14 52.4236111
15 2012-10-15 35.2048611
16 2012-10-16 52.3750000
17 2012-10-17 46.7083333
18 2012-10-18 34.9166667
19 2012-10-19 41.0729167
20 2012-10-20 36.0937500
21 2012-10-21 30.6284722
22 2012-10-22 46.7361111
23 2012-10-23 30.9652778
24 2012-10-24 29.0104167
25 2012-10-25  8.6527778
26 2012-10-26 23.5347222
27 2012-10-27 35.1354167
28 2012-10-28 39.7847222
29 2012-10-29 17.4236111
30 2012-10-30 34.0937500
31 2012-10-31 53.5208333
32 2012-11-01 37.3825996
33 2012-11-02 36.8055556
34 2012-11-03 36.7048611
35 2012-11-04 37.3825996
36 2012-11-05 36.2465278
37 2012-11-06 28.9375000
38 2012-11-07 44.7326389
39 2012-11-08 11.1770833
40 2012-11-09 37.3825996
41 2012-11-10 37.3825996
42 2012-11-11 43.7777778
43 2012-11-12 37.3784722
44 2012-11-13 25.4722222
45 2012-11-14 37.3825996
46 2012-11-15  0.1423611
47 2012-11-16 18.8923611
48 2012-11-17 49.7881944
49 2012-11-18 52.4652778
50 2012-11-19 30.6979167
51 2012-11-20 15.5277778
52 2012-11-21 44.3993056
53 2012-11-22 70.9270833
54 2012-11-23 73.5902778
55 2012-11-24 50.2708333
56 2012-11-25 41.0902778
57 2012-11-26 38.7569444
58 2012-11-27 47.3819444
59 2012-11-28 35.3576389
60 2012-11-29 24.4687500
61 2012-11-30 37.3825996
> newmedianstep
         date    steps
1  2012-10-01 34.11321
2  2012-10-02  0.00000
3  2012-10-03  0.00000
4  2012-10-04  0.00000
5  2012-10-05  0.00000
6  2012-10-06  0.00000
7  2012-10-07  0.00000
8  2012-10-08 34.11321
9  2012-10-09  0.00000
10 2012-10-10  0.00000
11 2012-10-11  0.00000
12 2012-10-12  0.00000
13 2012-10-13  0.00000
14 2012-10-14  0.00000
15 2012-10-15  0.00000
16 2012-10-16  0.00000
17 2012-10-17  0.00000
18 2012-10-18  0.00000
19 2012-10-19  0.00000
20 2012-10-20  0.00000
21 2012-10-21  0.00000
22 2012-10-22  0.00000
23 2012-10-23  0.00000
24 2012-10-24  0.00000
25 2012-10-25  0.00000
26 2012-10-26  0.00000
27 2012-10-27  0.00000
28 2012-10-28  0.00000
29 2012-10-29  0.00000
30 2012-10-30  0.00000
31 2012-10-31  0.00000
32 2012-11-01 34.11321
33 2012-11-02  0.00000
34 2012-11-03  0.00000
35 2012-11-04 34.11321
36 2012-11-05  0.00000
37 2012-11-06  0.00000
38 2012-11-07  0.00000
39 2012-11-08  0.00000
40 2012-11-09 34.11321
41 2012-11-10 34.11321
42 2012-11-11  0.00000
43 2012-11-12  0.00000
44 2012-11-13  0.00000
45 2012-11-14 34.11321
46 2012-11-15  0.00000
47 2012-11-16  0.00000
48 2012-11-17  0.00000
49 2012-11-18  0.00000
50 2012-11-19  0.00000
51 2012-11-20  0.00000
52 2012-11-21  0.00000
53 2012-11-22  0.00000
54 2012-11-23  0.00000
55 2012-11-24  0.00000
56 2012-11-25  0.00000
57 2012-11-26  0.00000
58 2012-11-27  0.00000
59 2012-11-28  0.00000
60 2012-11-29  0.00000
61 2012-11-30 34.11321
> newmeanstep01
[1] 10766.19
> newmedianstep01
[1] 10766.19
> newold <- rbind(data.frame(mean = c(meanstep01, newmeanstep01), median = c(medianstep01, newmedianstep01)))
> rownames(newold) <- c("with NA's", "without NA's")
> print(newold)
                 mean   median
with NA's    10766.19 10765.00
without NA's 10766.19 10766.19
```

# Are there differences in activity patterns between weekdays and weekends?
```r
> Sys.setlocale(category = "LC_ALL", locale = "english")
[1] "LC_COLLATE=English_United States.1252;LC_CTYPE=English_United States.1252;LC_MONETARY=English_United States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252"
> newactivity$daytype <- factor((weekdays(newactivity$date) %in% c("Saturday", "Sunday")), labels = c("Weekend", "weekday"))
> head(newactivity)
    steps       date interval daytype
289     0 2012-10-02        0 Weekend
290     0 2012-10-02        5 Weekend
291     0 2012-10-02       10 Weekend
292     0 2012-10-02       15 Weekend
293     0 2012-10-02       20 Weekend
294     0 2012-10-02       25 Weekend
> 
> newinterstep <- aggregate(steps ~ interval + daytype, newactivity, mean)
> newinterstep
    interval daytype        steps
1          0 Weekend 2.251153e+00
2          5 Weekend 4.452830e-01
3         10 Weekend 1.731656e-01
4         15 Weekend 1.979036e-01
5         20 Weekend 9.895178e-02
6         25 Weekend 1.590356e+00
7         30 Weekend 6.926625e-01
8         35 Weekend 1.137945e+00
9         40 Weekend 0.000000e+00
10        45 Weekend 1.796226e+00
> ggplot(newinterstep, aes(x=interval, y=steps)) + geom_line(aes(color = daytype)) + facet_grid(daytype ~ .) + ylab("Number of steps") + theme(legend.position="none")
```

























